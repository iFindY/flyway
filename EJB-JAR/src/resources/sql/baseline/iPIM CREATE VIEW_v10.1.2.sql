CREATE OR REPLACE VIEW SUPPLIER_PRODUCT_VIEW (ID, SUPPLIER, IDENTIFIERTYPE, IDENTIFIER ) AS
SELECT CSV.ID, CSV.SUPPLIER, CSVID.IDENTIFIERTYPE, CSVID.IDENTIFIERVALUE
  FROM IMP_CSV_IDENTIFIER CSVID, IMP_CSV CSV
 WHERE CSV.ID = CSVID.IMPCSV;

CREATE OR REPLACE VIEW SUPPLIER_PRODUCT_VALUE_VIEW (ID, "KEY", "VALUE", ISOCODE, IDENTIFIERTYPE) AS
  SELECT AV.IMPCSV, AV.IDENTIFIER, LOWER(AV."VALUE"), AV.ISOCODE, AV.IDENTIFIERTYPE FROM IMP_CSV_AV AV
UNION
  SELECT ERP.IMPORTEDROW, ERPAV."KEY", LOWER(ERPAV."VALUE"), '', ''
    FROM ERP_IMPORT_ARTICLE_AV ERPAV, ERP_IMPORT_ARTICLE ERP
   WHERE ERP.ID = ERPAV.ERPIMPORTARTICLE;
